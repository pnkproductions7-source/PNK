<html>

<head>

    <link rel="stylesheet" href="/src/css/style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PNK Video Productions</title>

</head>

<body>

    <nav class="mobile-nav">
        <div class="nav-inner">
            <a href="/index.html" class="logo-link">
                <img src="/static/img/logos/pnk-logo.png" alt="Logo" class="logo">
            </a>

            <!-- Desktop menu – εμφανίζεται μόνο σε PC -->
            <ul class="desktop-menu">
                <li><a href="/collection.html">Συλλογή</a></li>
                <li><a href="/contact.html">Επικοινωνία</a></li>
            </ul>

            <!-- Mobile toggle & dropdown – μένει όπως είναι -->
            <button class="menu-toggle" aria-label="Toggle menu" aria-expanded="false">
                <img src="/static/img/icons/menu.svg" class="icon hamburger" alt="Open menu">
                <img src="/static/img/icons/close.svg" class="icon close" alt="Close menu">
            </button>

            <div class="dropdown-menu">
                <ul class="menu-items">
                    <li><a href="/collection.html">Συλλογή</a></li>
                    <li><a href="/contact.html">Επικοινωνία</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <section id="gallery" class="content-section">
        <div class="gallery-inner">
            <h1>Συλλογή</h1>
            <div id="portfolio-categories"></div>
        </div>
    </section>

    <footer class="footer">
        <div class="footer-container">
            <!-- Logo – αριστερά σε desktop -->
            <div class="footer-logo">
                <img src="/static/img/logos/logo.jpg" alt="PNK Logo" class="logo">
            </div>

            <!-- Social icons – δεξιά σε desktop -->
            <div class="social-icons">
                <a href="https://www.facebook.com/p/PNK-Video-Productions-100069765463192/" target="_blank"
                    rel="noopener" aria-label="Facebook" class="social-link">
                    <div class="icon-circle">
                        <img src="/static/img/icons/facebook.svg" alt="Facebook" class="social-icon">
                    </div>
                </a>
                <a href="https://www.instagram.com/pnk_video_productions/" target="_blank" rel="noopener"
                    aria-label="Instagram" class="social-link">
                    <div class="icon-circle">
                        <img src="/static/img/icons/instagram.svg" alt="Instagram" class="social-icon">
                    </div>
                </a>
                <a href="https://www.tiktok.com/@pnkvideoproductions?_r=1&_t=ZN-93Yh90sA4Pe" target="_blank"
                    rel="noopener" aria-label="TikTok" class="social-link">
                    <div class="icon-circle">
                        <img src="/static/img/icons/tiktok.svg" alt="TikTok" class="social-icon">
                    </div>
                </a>
                <a href="viber://chat?number=+306912345678" aria-label="Viber" class="social-link">
                    <div class="icon-circle">
                        <img src="/static/img/icons/viber.svg" alt="Viber" class="social-icon">
                    </div>
                </a>
            </div>

            <!-- Copyright – πάντα κεντραρισμένο από κάτω -->
            <div class="footer-copyright">
                © 2026 PNK Video Productions. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- Modal -->
    <div id="galleryModal" class="modal">
        <div class="modal-content">
            <div class="modal-body">
                <iframe id="modalVideo" src="" frameborder="0" allowfullscreen
                    allow="autoplay; fullscreen; picture-in-picture" style="display:none;"></iframe>
                <img id="modalImage" src="" alt="Μεγάλη εικόνα"
                    style="display:none; max-width:100%; max-height:90vh; object-fit:contain;">
            </div>
        </div>
    </div>

    <script src="/src/js/nav.js"></script>

    <!-- === ΠΛΗΡΕΣ SCRIPT ΓΙΑ PROJECTS === -->
    <script>
        fetch('/src/_data/projects/')
            .then(res => res.text())
            .then(html => {
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                const links = Array.from(doc.querySelectorAll('a'))
                    .map(a => a.href)
                    .filter(href => href.endsWith('.json'))
                    .map(href => href.split('/').pop());

                return Promise.all(links.map(file =>
                    fetch('/src/_data/projects/' + file)
                        .then(r => r.ok ? r.json() : null)
                        .catch(() => null)
                )).then(arr => arr.filter(Boolean));
            })
            .then(projects => {
                const container = document.getElementById('portfolio-categories');

                if (!projects || projects.length === 0) {
                    container.innerHTML = '<p style="text-align:center; color:#888; padding: 4rem; font-size: 1.3rem;">Δεν υπάρχουν projects ακόμα.</p>';
                    return;
                }

                // Κατηγορίες (ελληνικά ονόματα)
                const categories = {
                    mystery: "Οπτικοακουστική Κάλυψη Μυστηρίων",
                    music: "Μουσικά Video Clip",
                    promo: "Video Promo",
                    artistic: "Οργάνωση Καλλιτεχνικών Προγραμμάτων"
                };

                // Ομαδοποίηση projects ανά κατηγορία
                const grouped = {};
                projects.forEach(p => {
                    const cat = p.category || 'promo';
                    if (!grouped[cat]) grouped[cat] = [];
                    grouped[cat].push(p);
                });

                // Δημιουργία κατηγοριών και items
                Object.keys(categories).forEach(key => {
                    const catProjects = grouped[key] || [];
                    if (catProjects.length === 0) return;

                    const catDiv = document.createElement('div');
                    catDiv.className = 'gallery-category';
                    catDiv.innerHTML = `<h2>${categories[key]}</h2><div class="gallery-grid"></div>`;
                    const grid = catDiv.querySelector('.gallery-grid');

                    // Ταξινόμηση με βάση το order (μικρότερο πρώτο)
                    catProjects.sort((a, b) => (a.order || 999999) - (b.order || 999999));

                    catProjects.forEach(p => {
                        let thumbnail = p.thumbnail || '/static/img/placeholder.jpg';
                        let embedUrl = '';

                        // Αν υπάρχει YouTube link → φτιάξε embed URL και thumbnail από YouTube
                        if (p.youtube_url) {
                            const match = p.youtube_url.match(/(?:youtu\.be\/|youtube\.com\/(?:embed\/|watch\?v=))([a-zA-Z0-9_-]{11})/);
                            const videoId = match ? match[1] : '';
                            if (videoId) {
                                embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&loop=1&playlist=${videoId}&controls=1&rel=0&modestbranding=1`;
                                thumbnail = p.thumbnail || `https://img.youtube.com/vi/${videoId}/hqdefault.jpg`;
                            }
                        }

                        const item = document.createElement('div');
                        item.className = 'gallery-item';
                        item.dataset.embed = embedUrl;     // για βίντεο
                        item.dataset.full = thumbnail;      // για εικόνα

                        item.innerHTML = `
                    <div class="video-wrapper">
                        <img src="${thumbnail}" alt="${p.title || 'Εικόνα'}" loading="lazy" class="thumbnail">
                    </div>
                    <div class="item-info">
                        <h3>${p.title || 'Χωρίς τίτλο'}</h3>
                        <p>${p.description || ''}</p>
                    </div>
                `;
                        grid.appendChild(item);
                    });

                    container.appendChild(catDiv);
                });

                // Modal logic – ανοίγει βίντεο ή εικόνα ανάλογα
                document.querySelectorAll('.gallery-item').forEach(item => {
                    item.addEventListener('click', () => {
                        const embed = item.dataset.embed;
                        const full = item.dataset.full;

                        const modal = document.getElementById('galleryModal');
                        const modalVideo = document.getElementById('modalVideo');
                        const modalImage = document.getElementById('modalImage');

                        // Reset
                        modalVideo.src = '';
                        modalImage.src = '';
                        modalVideo.style.display = 'none';
                        modalImage.style.display = 'none';

                        if (embed) {
                            // Βίντεο
                            modalVideo.src = embed;
                            modalVideo.style.display = 'block';
                        } else if (full) {
                            // Εικόνα
                            modalImage.src = full;
                            modalImage.style.display = 'block';
                        }

                        modal.style.display = 'flex';
                    });
                });

                // Κλείσιμο modal με κλικ έξω
                document.getElementById('galleryModal').addEventListener('click', (e) => {
                    if (e.target === document.getElementById('galleryModal')) {
                        document.getElementById('galleryModal').style.display = 'none';
                        document.getElementById('modalVideo').src = '';
                        document.getElementById('modalImage').src = '';
                    }
                });
            })
            .catch(err => {
                console.error("Error loading projects:", err);
                document.getElementById('portfolio-categories').innerHTML = '<p style="color:red; text-align:center; padding:4rem;">Πρόβλημα φόρτωσης projects. Δοκίμασε αργότερα.</p>';
            });
    </script>

</body>

</html>